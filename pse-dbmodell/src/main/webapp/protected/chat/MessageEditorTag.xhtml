<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">
<h:body>
	<h:form>
		<p:growl id="growlMessage" sticky="false" showDetail="true"
			life="5000" />

		<p:panelGrid>

			<p:row>
				<p:column colspan="2">Neue Nachricht eingeben</p:column>
			</p:row>
			<p:row>
				<p:column></p:column>
				<p:column>
					<p:outputLabel for="headline" value="Überschrift:" />
					<p:inputText id="headline"
						value="#{messageEditorController.headline}" required="true"
						label="Überschrift">
						<f:validateLength minimum="8" maximum="64" />
					</p:inputText>
				</p:column>
			</p:row>
			<p:row>
				<p:column>
					<p:graphicImage id="messageIcon"
						value="#{messageEditorController.iconRef}" width="200px" />
				</p:column>
				<p:column>
					<p:editor id="contentEditor" widgetVar="editorWidget"
						value="#{messageEditorController.richText}" required="true"
						label="Nachrichtentext" />
				</p:column>
			</p:row>
			<p:row>
				<p:column colspan="2">
					<p:outputLabel>Icon</p:outputLabel>
					<p:fileUpload
						fileUploadListener="#{messageEditorController.handleIconUpload()}"
						mode="advanced" dragDropSupport="true" update="growlMessage"
						multiple="false" sizeLimit="10000000"
						allowTypes="/(\.|\/)(jpe?g|png)$/" />
				</p:column>
			</p:row>
			<p:row>
				<p:column colspan="2">
					<p:outputLabel>Dokument</p:outputLabel>
					<p:fileUpload
						fileUploadListener="#{messageEditorController.handleDocumentUpload}"
						mode="advanced" dragDropSupport="true" update="growlMessage"
						multiple="false" sizeLimit="10000000"
						allowTypes="/(\.|\/)(jpe?g|png)$/" />
				</p:column>
			</p:row>
			<p:row>
				<p:column>
					<p:outputLabel for="targetCommunities" value="Communities" />
				</p:column>
				<p:column>
					<p:autoComplete id="targetCommunities" multiple="true"
						value="#{messageEditorController.selectedCommunities}"
						completeMethod="#{messageEditorController.completeCommunity}"
						converter="communityConverter"
						var="communityDTO" 
						itemLabel="#{communityDTO.name}"
						itemValue="#{communityDTO}"
						forceSelection="true"
						minQueryLength="3"
						required="true"						
						>
						<p:ajax event="itemSelect" listener="#{messageEditorController.handleSelect}" />
						<p:ajax event="itemUnselect" listener="#{messageEditorController.handleUnselect}" />

						<f:facet name="itemTip">#{communityDTO.name}</f:facet>

					</p:autoComplete>
				</p:column>
			</p:row>
			<p:row>
				<p:column rowspan="2">
					<p:commandButton value="Speichern" icon="ui-icon-disk"
						validateClient="true" ajax="false"
						actionListener="messageEditorController.save()" />
				</p:column>
			</p:row>
		</p:panelGrid>
	</h:form>
</h:body>
</html>