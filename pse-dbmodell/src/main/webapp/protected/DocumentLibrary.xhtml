<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">
	<f:metadata>
		<f:viewParam name="communityId"
			value="#{documentLibraryController.communityId}" />
	</f:metadata>

	<f:event type="preRenderComponent"
		listener="#{documentLibraryController.init}" />
	<p:panel id="documentLibraryPnl" header="Dokumentenbibliothek">
		<h:form>

			<p:toolbar rendered="#{documentLibraryController.canEditLibrary}">
				<f:facet name="left">
					<p:commandButton id="uploadDocumentBtn" value="Neu"
						icon="ui-icon-circle-plus" process="@this"
						update="documentLibraryPnl"
						action="#{documentLibraryController.setIsInNewDocumentMode(true)}" />
				</f:facet>
			</p:toolbar>
			<p:dataTable var="entry" value="#{documentLibraryController.entries}"
				rendered="#{documentLibraryController.canViewLibrary and not documentLibraryController.isInNewDocumentMode}">
				<p:column headerText="Name">
					<p:link value="#{entry.name}" />
				</p:column>
				<p:column headerText="Beschreibung">
					<h:outputText value="#{entry.description}" />
				</p:column>
				<p:column headerText="Aktion">
					<p:splitButton value="Anzeigen">
						<p:menuitem value="LÃ¶schen"></p:menuitem>
					</p:splitButton>
				</p:column>
			</p:dataTable>
			</h:form>
				<p:panel id="UploadDocumentPnl"
					rendered="#{documentLibraryController.isInNewDocumentMode}">
					<h:form id="documentFrm">
						<p:fileUpload update="UploadDocumentPnl" mode="advanced"
							auto="true" process="documentFrm"
							fileUploadListener="#{documentLibraryController.uploadFileDocument}">
						</p:fileUpload>
						<p:outputLabel
							value="#{documentLibraryController.uploadedFileName}" />
						<p:inputText
							value="#{documentLibraryController.newDocumentDescription}"></p:inputText>
						<p:commandButton value="Speichern" id="commitUploadedDocumentBtn"
							action="#{documentLibraryController.saveNewDocument}"
							process="documentFrm" update="documentLibraryPnl" />
						<p:commandButton value="Abbrechen"
							action="#{documentLibraryController.setIsInNewDocumentMode(false)}"
							process="@this" update="documentLibraryPnl" />
					</h:form>
				</p:panel>
	</p:panel>
</ui:composition>